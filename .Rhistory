summary(college_mod)
# Chunk 5: college-q10-code
college_mod2 <- lm(GradRate ~ AdmisRate + Type + AdmisRate:Type, data = College)
summary(college_mod2)
College %>%
ggplot(aes(y=GradRate, x=AdmisRate, color=Type)) +
geom_point() +
geom_abline(aes(intercept=0.85220, slope=-0.30527, color='Private')) +
geom_abline(aes(intercept=0.63554, slope=-0.42085, color='Public'))
College %>%
ggplot(aes(y=GradRate, x=AdmisRate, color=Type)) +
geom_point() +
geom_abline(aes(intercept=0.87141, slope=-0.35044, color='Private')) +
geom_abline(aes(intercept=0.58945, slope=-0.35044, color='Public'))
College %>%
summarize(cor(x= AdmisRate, y= GradRate))
College %>%
ggplot(aes(y=GradRate, x=AdmisRate, color=Type)) +
geom_point() +
geom_abline(aes(intercept=0.85220, slope=-0.30527, color='Private')) +
geom_abline(aes(intercept=0.63554, slope=-0.42085, color='Public'))
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE, error = TRUE)
# Chunk 2: load-package
# load necessary packages
library(ggplot2)
library(dplyr)
# load datasets
College <- read.csv('https://raw.githubusercontent.com/vittorioaddona/data/main/College.csv')
SCI <- read.csv('https://raw.githubusercontent.com/vittorioaddona/data/main/SCI.csv')
bikeshare <- read.csv('https://raw.githubusercontent.com/vittorioaddona/data/main/BikeShare.csv')
# Chunk 3: college-q1-code
College %>%
ggplot(aes(y=GradRate, x=AdmisRate, color=Type)) +
geom_point() +
geom_abline(aes(intercept=0.87141, slope=-0.35044, color='Private')) +
geom_abline(aes(intercept=0.58945, slope=-0.35044, color='Public'))
College %>%
summarize(cor(x= AdmisRate, y= GradRate))
# Chunk 4: college-q5-code
college_mod <- lm(GradRate ~ AdmisRate + Type, data = College)
summary(college_mod)
# Chunk 5: college-q10-code
college_mod2 <- lm(GradRate ~ AdmisRate + Type + AdmisRate:Type, data = College)
summary(college_mod2)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE, error = TRUE)
# Chunk 2: load-package
# load necessary packages
library(ggplot2)
library(dplyr)
# load datasets
College <- read.csv('https://raw.githubusercontent.com/vittorioaddona/data/main/College.csv')
SCI <- read.csv('https://raw.githubusercontent.com/vittorioaddona/data/main/SCI.csv')
bikeshare <- read.csv('https://raw.githubusercontent.com/vittorioaddona/data/main/BikeShare.csv')
# Chunk 3: college-q1-code
College %>%
ggplot(aes(y=GradRate, x=AdmisRate, color=Type)) +
geom_point() +
geom_abline(aes(intercept=0.87141, slope=-0.35044, color='Private')) +
geom_abline(aes(intercept=0.58945, slope=-0.35044, color='Public'))
College %>%
summarize(cor(x= AdmisRate, y= GradRate))
# Chunk 4: college-q5-code
college_mod <- lm(GradRate ~ AdmisRate + Type, data = College)
summary(college_mod)
# Chunk 5: college-q10-code
college_mod2 <- lm(GradRate ~ AdmisRate + Type + AdmisRate:Type, data = College)
summary(college_mod2)
# Chunk 6: college-q12-code
College %>%
ggplot(aes(y=GradRate, x=AdmisRate, color=Type)) +
geom_point() +
geom_abline(aes(intercept=0.85220, slope=-0.30527, color='Private')) +
geom_abline(aes(intercept=0.63554, slope=-0.42085, color='Public'))
college_mod <- lm(GradRate ~ AdmisRate + Type, data = College)
summary(college_mod)
College %>%
ggplot(aes(y=GradRate, x=AdmisRate, color=Type)) +
geom_point() +
geom_abline(aes(intercept=0.87141, slope=-0.35044, color='Private')) +
geom_abline(aes(intercept=0.58945, slope=-0.35044, color='Public'))
College %>%
summarize(cor(x= AdmisRate, y= GradRate))
College %>%
ggplot(aes(y=GradRate, x=AdmisRate, color=Type)) +
geom_point() +
geom_abline(aes(intercept=0.85220, slope=-0.30527, color='Private')) +
geom_abline(aes(intercept=0.63554, slope=-0.42085, color='Public'))
head(SCI)
View(SCI)
SCI %>%
count(is.na(Cause))
SCI_complete <- SCI %>%
filter(!is.na(Cause))
View(SCI_complete)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)
Water_Data <- read_tsv('/Users/seamusmcmurrer/Library/CloudStorage/OneDrive-Personal/Documents/College/Year 3/Spring/Stats/Stats-155-Final-Project/37217-0001-Data.tsv')
Water_Data <- read_tsv('/Users/inbalarmony/Documents/GitHub/Stats-155-Final-Project')
Water_Data <- read_tsv('/Users/inbalarmony/Documents/GitHub/Stats-155-Final-Project/37217-0001-Data.tsv')
head(Water_Data)
library(stringr)
Water_Data <- Water_Data %>%
# changing not detected to 0!
mutate(TOTAL_TESTED_PFAS_PPT = ifelse(TOTAL_TESTED_PFAS_PPT == 'ND', 0,TOTAL_TESTED_PFAS_PPT)) %>%
mutate(PFOA_PFOS_PPT = ifelse(PFOA_PFOS_PPT == 'ND', 0,PFOA_PFOS_PPT))
Water_Data %>%
mutate(TOTAL_TESTED_PFAS_PPT = str_replace(TOTAL_TESTED_PFAS_PPT, ",","")) %>%
mutate(TOTAL_TESTED_PFAS_PPT = as.numeric(TOTAL_TESTED_PFAS_PPT)) %>%
summarize(mean(TOTAL_TESTED_PFAS_PPT))
head(Water_Data)
library(stringr)
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(stringr)
Water_Data <- Water_Data %>%
# changing not detected to 0!
mutate(TOTAL_TESTED_PFAS_PPT = ifelse(TOTAL_TESTED_PFAS_PPT == 'ND', 0,TOTAL_TESTED_PFAS_PPT)) %>%
mutate(PFOA_PFOS_PPT = ifelse(PFOA_PFOS_PPT == 'ND', 0,PFOA_PFOS_PPT))
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(stringr)
Water_Data <- read_tsv('/Users/inbalarmony/Documents/GitHub/Stats-155-Final-Project/37217-0001-Data.tsv')
Water_Data <- Water_Data %>%
# changing not detected to 0!
mutate(TOTAL_TESTED_PFAS_PPT = ifelse(TOTAL_TESTED_PFAS_PPT == 'ND', 0,TOTAL_TESTED_PFAS_PPT)) %>%
mutate(PFOA_PFOS_PPT = ifelse(PFOA_PFOS_PPT == 'ND', 0,PFOA_PFOS_PPT))
Water_Data %>%
mutate(TOTAL_TESTED_PFAS_PPT = str_replace(TOTAL_TESTED_PFAS_PPT, ",","")) %>%
mutate(TOTAL_TESTED_PFAS_PPT = as.numeric(TOTAL_TESTED_PFAS_PPT))
Water_Data <- read_tsv('/Users/inbalarmony/Documents/GitHub/Stats-155-Final-Project/37217-0001-Data.tsv')
Water_Data_New <- Water_Data %>%
# changing not detected to 0!
mutate(TOTAL_TESTED_PFAS_PPT = ifelse(TOTAL_TESTED_PFAS_PPT == 'ND', 0,TOTAL_TESTED_PFAS_PPT)) %>%
mutate(PFOA_PFOS_PPT = ifelse(PFOA_PFOS_PPT == 'ND', 0,PFOA_PFOS_PPT)) %>%
mutate(TOTAL_TESTED_PFAS_PPT = str_replace(TOTAL_TESTED_PFAS_PPT, ",","")) %>%
mutate(TOTAL_TESTED_PFAS_PPT = as.numeric(TOTAL_TESTED_PFAS_PPT))
View(Water_Data_New)
Water_Data_New %>%
group_by(COUNTY) %>%
head(10)
Water_Data_New %>%
group_by(COUNTY) %>%
mutate(num_entries = nrow())
Water_Data_New %>%
group_by(COUNTY) %>%
summarize(n())
Water_Data_New %>%
group_by(COUNTY) %>%
summarize(n()) %>%
head(10)
Water_Data_New %>%
group_by(COUNTY) %>%
summarize(n()) %>%
arrange(desc())
Water_Data_New %>%
group_by(COUNTY) %>%
summarize(num_sites = n()) %>%
arrange(desc(num_sites))
Top10 <- Water_Data_New %>%
group_by(COUNTY) %>%
summarize(num_sites = n()) %>%
arrange(desc(num_sites)) %>%
head(10)
Water_Data_New %>%
group_by(COUNTY) %>%
summarize(num_sites = n()) %>%
arrange(desc(num_sites)) %>%
head(10)
Water_Data_New %>%
group_by(COUNTY) %>%
summarize(num_sites = n()) %>%
arrange(desc(num_sites)) %>%
head(10)
?left_join
Water_Data_New %>%
group_by(COUNTY) %>%
summarize(num_sites = n()) %>%
arrange(desc(num_sites)) %>%
head(10) %>%
left_join(Water_Data_New, by = COUNTY)
Water_Data_New %>%
group_by(COUNTY) %>%
summarize(num_sites = n()) %>%
arrange(desc(num_sites)) %>%
head(10) %>%
left_join(Water_Data_New, by = `COUNTY`)
Water_Data_New %>%
group_by(COUNTY) %>%
summarize(num_sites = n()) %>%
arrange(desc(num_sites)) %>%
head(10) %>%
left_join(Water_Data_New)
View(Top10)
Top10 <- Water_Data_New %>%
group_by(COUNTY) %>%
summarize(num_sites = n()) %>%
arrange(desc(num_sites)) %>%
head(10) %>%
left_join(Water_Data_New)
left_
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(stringr)
Water_Data <- read_tsv('/Users/inbalarmony/Documents/GitHub/Stats-155-Final-Project/37217-0001-Data.tsv')
Water_Data_New <- Water_Data %>%
# changing not detected to 0!
mutate(TOTAL_TESTED_PFAS_PPT = ifelse(TOTAL_TESTED_PFAS_PPT == 'ND', 0,TOTAL_TESTED_PFAS_PPT)) %>%
mutate(PFOA_PFOS_PPT = ifelse(PFOA_PFOS_PPT == 'ND', 0,PFOA_PFOS_PPT)) %>%
mutate(TOTAL_TESTED_PFAS_PPT = str_replace(TOTAL_TESTED_PFAS_PPT, ",","")) %>%
mutate(TOTAL_TESTED_PFAS_PPT = as.numeric(TOTAL_TESTED_PFAS_PPT))
Top10 <- Water_Data_New %>%
group_by(COUNTY) %>%
summarize(num_sites = n()) %>%
arrange(desc(num_sites)) %>%
head(10) %>%
left_join(Water_Data_New)
top10 %>%
ggplot(aes(x=COUNTY, fill=TOTAL_TESTED_PFAS_PPT)) +
geom_bar(position='fill')
Top10 %>%
ggplot(aes(x=COUNTY, fill=TOTAL_TESTED_PFAS_PPT)) +
geom_bar(position='fill')
Top10 %>%
ggplot(aes(x=COUNTY, fill=TOTAL_TESTED_PFAS_PPT)) +
geom_bar(position='dodge')
Top10 %>%
ggplot(aes(x=COUNTY, fill=TOTAL_TESTED_PFAS_PPT)) +
geom_bar(position='dodge') +
labs(title="PFAS Levels in Ten Most Tested Michigan Counties")
Top10 %>%
ggplot(aes(x=COUNTY, fill=TOTAL_TESTED_PFAS_PPT)) +
geom_bar(position='dodge') +
labs(title="Count of PFAS Levels in Ten Most Tested Michigan Counties", y="Count of PFAS in Tested Water (ppt)", x="County")
Top10 %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE))
Top10 %>%
ggplot(aes(x=COUNTY, fill=TOTAL_TESTED_PFAS_PPT)) +
geom_bar(position='dodge') +
labs(title="Count of PFAS Levels in Ten Most Tested Michigan Counties", y="Count of PFAS in Tested Water (ppt)", x="County")
Top10 %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE)) %>%
ggplot(aes(x=COUNTY, fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County")
Top10 %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE)) %>%
ggplot(aes(x=reorder(COUNTY, -PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County")
Top10 %>%
ggplot(aes(x=COUNTY, y=TOTAL_TESTED_PFAS_PPT)) +
geom_bar(position='dodge') +
labs(title="Count of PFAS Levels in Ten Most Tested Michigan Counties", y="Count of PFAS in Tested Water (ppt)", x="County")
Top10 %>%
ggplot(aes(x=COUNTY, fill=TOTAL_TESTED_PFAS_PPT)) +
geom_bar(position='dodge') +
labs(title="Count of PFAS Levels in Ten Most Tested Michigan Counties", y="Count of PFAS in Tested Water (ppt)", x="County")
Top10 %>%
ggplot(aes(x=COUNTY, y=TOTAL_TESTED_PFAS_PPT)) +
geom_boxplot() +
labs(title="PFAS Levels in Ten Most Tested Michigan Counties", fill="PFAS in Tested Water (ppt)", x="County")
Top10 %>%
ggplot(aes(x=COUNTY, y=TOTAL_TESTED_PFAS_PPT)) +
geom_boxplot(~facet_wrap) +
labs(title="PFAS Levels in Ten Most Tested Michigan Counties", fill="PFAS in Tested Water (ppt)", x="County")
Top10 %>%
ggplot(aes(x=COUNTY, y=TOTAL_TESTED_PFAS_PPT)) +
geom_boxplot() +
labs(title="PFAS Levels in Ten Most Tested Michigan Counties", y="PFAS in Tested Water (ppt)", x="County")
Top10 %>%
filter(COUNTY == "KALAMAZOO") %>%
summarize(mean(TOTAL_TESTED_PFAS_PPT))
Top10 %>%
filter(COUNTY == "KALAMAZOO") %>%
summarize(max(TOTAL_TESTED_PFAS_PPT))
Top10 %>%
filter(COUNTY == "KALAMAZOO")
Top10 %>%
ggplot(aes(x=COUNTY, y=TOTAL_TESTED_PFAS_PPT)) +
geom_boxplot() +
labs(title="PFAS Levels in Ten Most Tested Michigan Counties", y="PFAS in Tested Water (ppt)", x="County")
Top10 %>%
filter(!COUNTY == "KALAMAZOO") %>%
ggplot(aes(x=COUNTY, y=TOTAL_TESTED_PFAS_PPT)) +
geom_boxplot() +
labs(title="PFAS Levels in Ten Most Tested Michigan Counties", y="PFAS in Tested Water (ppt)", x="County")
Top10 %>%
filter(COUNTY == "KALAMAZOO") %>%
ggplot(aes(x=COUNTY, y=TOTAL_TESTED_PFAS_PPT)) +
geom_boxplot() +
labs(title="PFAS Levels in Ten Most Tested Michigan Counties", y="PFAS in Tested Water (ppt)", x="County")
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(stringr)
Water_Data <- read_tsv('/Users/inbalarmony/Documents/GitHub/Stats-155-Final-Project/37217-0001-Data.tsv')
head(Water_Data)
Water_Data_New <- Water_Data %>%
# changing not detected to 0!
mutate(TOTAL_TESTED_PFAS_PPT = ifelse(TOTAL_TESTED_PFAS_PPT == 'ND', 0,TOTAL_TESTED_PFAS_PPT)) %>%
mutate(PFOA_PFOS_PPT = ifelse(PFOA_PFOS_PPT == 'ND', 0,PFOA_PFOS_PPT)) %>%
mutate(TOTAL_TESTED_PFAS_PPT = str_replace(TOTAL_TESTED_PFAS_PPT, ",","")) %>%
mutate(TOTAL_TESTED_PFAS_PPT = as.numeric(TOTAL_TESTED_PFAS_PPT))
Water_Data_New %>%  summarize(mean(TOTAL_TESTED_PFAS_PPT))
# New data set with just the top 10 counties (based off of number of test sites)
Top10 <- Water_Data_New %>%
group_by(COUNTY) %>%
summarize(num_sites = n()) %>%
arrange(desc(num_sites)) %>%
head(10) %>%
left_join(Water_Data_New)
# fix, only doing PFAS
Top10 %>%
ggplot(aes(x=COUNTY, y=TOTAL_TESTED_PFAS_PPT)) +
geom_boxplot() +
labs(title="PFAS Levels in Ten Most Tested Michigan Counties", y="PFAS in Tested Water (ppt)", x="County")
Top10 %>%
filter(!COUNTY == "KALAMAZOO") %>%
ggplot(aes(x=COUNTY, y=TOTAL_TESTED_PFAS_PPT)) +
geom_boxplot() +
labs(title="PFAS Levels in Ten Most Tested Michigan Counties", y="PFAS in Tested Water (ppt)", x="County")
Top10 %>%
filter(COUNTY == "KALAMAZOO") %>%
ggplot(aes(x=COUNTY, y=TOTAL_TESTED_PFAS_PPT)) +
geom_boxplot() +
labs(title="PFAS Levels in Ten Most Tested Michigan Counties", y="PFAS in Tested Water (ppt)", x="County")
Top10 %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE)) %>%
ggplot(aes(x=reorder(COUNTY, -PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County")
Top10 %>%
filter(COUNTY == "KALAMAZOO")
#Not sure if this is exactly what we're looking for, can adjust if needed.
Top10 %>%
ggplot(aes(x = POPULATION_SERVED, y = TOTAL_TESTED_PFAS_PPT)) +
geom_point() +
scale_x_log10(labels = scales::comma_format()) +
scale_y_log10() +
labs(title = "Population Drinking PFAS Contaminated Water in the Ten Most Tested Michigan Counties", x = "Population Served", y = "PFAS Levels")
Top10 %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE)) %>%
ggplot(aes(x=reorder(COUNTY, -PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County")
Top10 %>%
ggplot(aes(x = POPULATION_SERVED, y = TOTAL_TESTED_PFAS_PPT)) +
geom_point() +
scale_x_log10(labels = scales::comma_format()) +
scale_y_log10() +
labs(title = "Population Drinking PFAS Contaminated Water in the Ten Most Tested Michigan Counties", x = "Population Served", y = "PFAS Levels")
Top10 %>%
filter(TOTAL_TESTED_PFAS_PPT>0) %>%
ggplot(aes(x = POPULATION_SERVED, y = TOTAL_TESTED_PFAS_PPT)) +
geom_point() +
scale_x_log10(labels = scales::comma_format()) +
scale_y_log10() +
labs(title = "Population Drinking PFAS Contaminated Water in the Ten Most Tested Michigan Counties", x = "Population Served", y = "PFAS Levels")
Top10 %>%
filter(TOTAL_TESTED_PFAS_PPT>0) %>%
ggplot(aes(x = POPULATION_SERVED, y = TOTAL_TESTED_PFAS_PPT)) +
geom_point() +
labs(title = "Population Drinking PFAS Contaminated Water in the Ten Most Tested Michigan Counties", x = "Population Served", y = "PFAS Levels")
Top10 %>%
filter(TOTAL_TESTED_PFAS_PPT>0) %>%
ggplot(aes(x = POPULATION_SERVED, y = TOTAL_TESTED_PFAS_PPT)) +
geom_point() +
scale_x_log10(labels = scales::comma_format()) +
scale_y_log10() +
labs(title = "Population Drinking PFAS Contaminated Water in the Ten Most Tested Michigan Counties", x = "Population Served", y = "PFAS Levels")
Top10 %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE)) %>%
ggplot(aes(x=reorder(COUNTY, -PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County")
Top10 %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE)) %>%
ggplot(aes(x=reorder(COUNTY, -PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County") +
geom_text(data=Top10, size = 4, angle=40, aes(x = COUNTY), y =7500)
Top10 %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE)) %>%
ggplot(aes(x=reorder(COUNTY, -PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County")
Top10 %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE)) %>%
ggplot(aes(x=reorder(COUNTY, -PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County") +
geom_text(data=Top10, size = 4, angle=40, aes(x = x=reorder(COUNTY, -PFAS_YES)), y =7500)
Top10 %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE)) %>%
ggplot(aes(x=reorder(COUNTY, -PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County") +
geom_text(data=Top10, size = 4, angle=40, aes(x=reorder(COUNTY, -PFAS_YES)), y =7500)
View(Top10)
Top10 %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE)) %>%
ggplot(aes(x=reorder(COUNTY, -PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County")
Top10 %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE)) %>%
ggplot(aes(x=reorder(COUNTY, PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County")
Top10 %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE)) %>%
ggplot(aes(x=reorder(COUNTY, PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County") +
geom_text(data=Top10, size = 4, angle=40, aes(x=reorder(COUNTY, PFAS_YES)))
Top10
Top10 <- Water_Data_New %>%
group_by(COUNTY) %>%
summarize(num_sites = n()) %>%
arrange(desc(num_sites)) %>%
head(10) %>%
left_join(Water_Data_New) %>%
mutate(PFAS_YES=ifelse(TOTAL_TESTED_PFAS_PPT>0, TRUE, FALSE))
Top10 %>%
ggplot(aes(x=reorder(COUNTY, PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County") +
geom_text(data=Top10, size = 4, angle=40, aes(x=reorder(COUNTY, PFAS_YES)))
Top10 %>%
ggplot(aes(x=reorder(COUNTY, PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County") +
geom_text(data=Top10, size = 4, angle=40, aes(x=reorder(COUNTY, PFAS_YES)), y=700, label=Top10$COUNTY)
Top10 %>%
ggplot(aes(x=reorder(COUNTY, PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County") +
opts(axis.text.x=theme_text(angle=-90))
Top10 %>%
ggplot(aes(x=reorder(COUNTY, PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
Top10 %>%
ggplot(aes(x=reorder(COUNTY, PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County") +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
Top10 %>%
ggplot(aes(x=reorder(COUNTY, PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County") +
theme(axis.text.x = element_text(angle = 45, vjust = 0, hjust=1))
Top10 %>%
ggplot(aes(x=reorder(COUNTY, PFAS_YES), fill=PFAS_YES)) +
geom_bar(position='fill') +
labs(title="Presence of PFAS Contaminated Water in the Ten Most Tested Michigan Counties", fill="Presence of PFAS in Tested Water", x="County") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
library("USAboundaries")
library(ggmap)
library("USAboundaries")
gmap::register_google(key = Sys.getenv("Google_key"))
ggmap::register_google(key = Sys.getenv("Google_key"))
world <- get_googlemap(
center = c(lon =  7.909252, lat = 0.427311),
maptype = "terrain",
zoom = 1
)
world <- get_googlemap(
center = c(lon =  7.909252, lat = 0.427311),
maptype = "terrain",
zoom = 1)
ggmap::register_google(key = Sys.getenv("Google_key"))
world <- get_googlemap(
center = c(lon =  7.909252, lat = 0.427311),
maptype = "terrain",
zoom = 1)
library(ggmap)
mod1 <- lm(TOTAL_TESTED_PFAS_PPT ~ COUNTY, data=Top10)
summary(mod1)
mod2 <- lm(TOTAL_TESTED_PFAS_PPT ~ COUNTY + POPULATION_SERVED, data=Top10)
summary(mod1)
mod3 <- lm(TOTAL_TESTED_PFAS_PPT ~ COUNTY + RAW_OR_TREATED, data=Top10)
summary(mod1)
mod2 <- lm(TOTAL_TESTED_PFAS_PPT ~ COUNTY + POPULATION_SERVED, data=Top10)
summary(mod2)
mod1 <- lm(TOTAL_TESTED_PFAS_PPT ~ COUNTY, data=Top10)
summary(mod1)
mod_pop <- lm(TOTAL_TESTED_PFAS_PPT ~ POPULATION_SERVED, data=Top10)
summary(mod_pop)
mod_type <- lm(TOTAL_TESTED_PFAS_PPT ~ RAW_OR_TREATED, data=Top10)
summary(mod_type)
mod3 <- lm(TOTAL_TESTED_PFAS_PPT ~ COUNTY + RAW_OR_TREATED, data=Top10)
summary(mod3)
main_model <- lm(TOTAL_TESTED_PFAS_PPT ~ COUNTY + POPULATION_SERVED + RAW_OR_TREATED, data=Top10)
summary(main_model)
